# ============================================================
# Drum Score Player v0.7
# テキスト譜面フォーマット仕様（正式版）
# ============================================================
#
# これは Drum Score Player v0.7 における「テキスト譜面」の
# 公式仕様です。譜面ファイル（.txt）は、このルールに従って
# 記述する必要があります。
#
# この仕様は、教材用の譜面制作・アプリの安定解析・
# マルチバー（複数小節）対応のために最適化されています。
#
# ------------------------------------------------------------
# 1. ヘッダー（必須／順不同）
# ------------------------------------------------------------
# 以下の3つは必ず必要：
#
#   TEMPO=78
#   TIME=4/4
#   PULSES_PER_BEAT=4
#
# 以下は任意（なくても動作する）：
#
#   FILENAME=Example.txt
#   TITLE=Cool Groove
#
# ------------------------------------------------------------
# 2. トラック定義（HH / SD / BD など）
# ------------------------------------------------------------
# フォーマット：
#   トラック名: トークン トークン トークン...
#
# 行が長くなる場合、2行目以降はトラック名を省略してよい。
#
#   HH: x1 x1 x1 x1
#       x1 x1 x1 x1
#
# トラック名は自由（HH, SD, BD, LT, HT, Ride... 何でもOK）。
#
# ------------------------------------------------------------
# 3. 小節区切り記号 "|"（任意）
# ------------------------------------------------------------
# 見やすさのために "|" を自由に入れてよい。
# アプリは完全に無視して解析する。
#
#   HH: x1 x1 x1 x1 | x1 x1 x1 x1 |
#
# 入れても、入れなくてもよい。
#
# ------------------------------------------------------------
# 4. コメント（任意）
# ------------------------------------------------------------
# 行頭の "#" から行末まではコメントとして扱われる。
# トラック行の中に書いても解析に影響しない。
#
#   # Bar 1
#   HH: x1 x1 x1 x1   # これはコメント
#
# ------------------------------------------------------------
# 5. 音符トークン（最重要）
# ------------------------------------------------------------
# すべて「記号 + 数値」で構成される。
#
# ● 音符
#   xN   → Nステップ鳴らす
#   oN   → 同上（見た目や好みで使い分け可）
#   XN, ON も許可
#
# ● 休符
#   -N   → Nステップ休む
#   rN, RN, _N も休符として有効
#
# N は整数（1, 2, 3, 4...）。
#
# ------------------------------------------------------------
# 6. 強弱記号（任意）
# ------------------------------------------------------------
# トークン末尾に "^強弱" を追加できる。
#
#   x1^f   → 強く
#   o1^pp  → とても弱く
#
# 認識される強弱は以下のみ：
#   pp, p, mp, mf, f, ff
#
# ------------------------------------------------------------
# 7. 小節判定（非常に重要）
# ------------------------------------------------------------
# TIME と PULSES_PER_BEAT から 1小節のステップ数を求める：
#
#   1小節ステップ数 = TIMEの分子 × PULSES_PER_BEAT
#
# 例：TIME=4/4, PULSES_PER_BEAT=4 → 1小節 = 16ステップ
#
# 各トラックの合計ステップ数は、
#
#   16, 32, 48, 64 ... のように 1小節の整数倍でなければならない。
#
# 整数倍でない場合はエラー：
#
#   [ERROR] トラック HH: 合計 34 ステップは 1小節16 の整数倍ではありません。
#
# ------------------------------------------------------------
# 8. 禁止事項（解析不能）
# ------------------------------------------------------------
# ● トークン中に文字列を混ぜる：
#     x1 aaa x1    → NG
#
# ● カンマ区切り：
#     x1,x1,x1     → NG
#
# ● 全角スペースを使う：
#     x1　x1       → NG（解析失敗する可能性あり）
#
# ● 未知の記号：
#     y1           → NG
#
# ------------------------------------------------------------
# 9. 正しい例（複数小節）
# ------------------------------------------------------------
#
#   TEMPO=90
#   TIME=4/4
#   PULSES_PER_BEAT=4
#
#   HH: x1 x1 x1 x1 | x1 x1 x1 x1
#   SD: -4 x1 -3 -4 x1 -3
#   BD: o1 -3 -4 o1 -3 -4
#
# すべて 16ステップ（1小節）または 32ステップ（2小節）など、整数倍ならOK。
#
# ------------------------------------------------------------
# 10. 付点音符（dotted note）の扱い
# ------------------------------------------------------------
# 付点は「計算済みのステップ数」に変換して書く。
#
# 例：付点8分 = 1.5 × 4ステップ = 6ステップ
#   → x6 と書く
#
# アプリは記号としての “付点” を理解しない。
# ------------------------------------------------------------
#
# 以上が Drum Score Player v0.7 の完全なテキスト仕様です。
#
# ============================================================
